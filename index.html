<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ‚Ÿç©ºçš„ä¿¡æ¯å“¨å…µ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style> .no-scrollbar::-webkit-scrollbar { display: none; } </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <header class="sticky top-0 bg-white/80 backdrop-blur-md shadow-sm z-50">
        <div class="max-w-xl mx-auto p-4">
            <h1 class="text-xl font-bold mb-4 text-center">ğŸ›¡ï¸ æ‚Ÿç©ºçš„ä¿¡æ¯å“¨å…µ</h1>
            <div id="filter-company" class="flex gap-2 overflow-x-auto pb-1 no-scrollbar text-sm"></div>
        </div>
    </header>

    <main id="app" class="max-w-xl mx-auto p-4">
        <div id="list-container" class="text-center py-20 text-gray-400">æ­£åœ¨åŒæ­¥è¿‘ä¸€å‘¨æƒ…æŠ¥...</div>
    </main>

    <script>
        let rawData = [];

        async function init() {
            try {
                const res = await fetch('./data.json?t=' + Date.now());
                rawData = await res.json();
                
                if (!Array.isArray(rawData) || rawData.length === 0) {
                    document.getElementById('list-container').innerHTML = "æš‚æ— æƒ…æŠ¥ï¼Œå“¨å…µå·¡é€»ä¸­...";
                    return;
                }

                // æ¸²æŸ“ç­›é€‰æŒ‰é’®
                const cos = ['å…¨éƒ¨', ...new Set(rawData.map(d => d.company))];
                document.getElementById('filter-company').innerHTML = cos.map(c => 
                    `<button onclick="filter('${c}', this)" class="btn-filter whitespace-nowrap px-4 py-1.5 bg-gray-100 rounded-full">${c}</button>`
                ).join('');
                
                render(rawData);
            } catch (e) {
                document.getElementById('list-container').innerHTML = "æ•°æ®åŠ è½½å¼‚å¸¸";
            }
        }

        function render(data) {
            const container = document.getElementById('list-container');
            container.innerHTML = "";
            container.classList.remove('text-center', 'py-20', 'text-gray-400');

            // åˆ†ç»„
            const groups = {};
            data.forEach(item => {
                if(!groups[item.date]) groups[item.date] = [];
                groups[item.date].push(item);
            });

            Object.keys(groups).sort().reverse().forEach(date => {
                const section = document.createElement('div');
                section.className = "mb-8";
                section.innerHTML = `
                    <div class="flex items-center mb-4 text-gray-400">
                        <div class="h-px bg-gray-200 flex-grow"></div>
                        <span class="px-3 text-[10px] font-bold">${date}</span>
                        <div class="h-px bg-gray-200 flex-grow"></div>
                    </div>
                    <div class="space-y-4">
                        ${groups[date].map(item => `
                            <div class="bg-white rounded-2xl p-5 shadow-sm border border-gray-100">
                                <div class="flex justify-between items-center mb-2">
                                    <span class="text-xs font-bold text-blue-600">${item.company}</span>
                                    <span class="text-[10px] text-gray-400">${item.category}</span>
                                </div>
                                <a href="${item.link}" target="_blank" class="block font-medium hover:text-blue-600">${item.content}</a>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(section);
            });
        }

        function filter(c, btn) {
            document.querySelectorAll('.btn-filter').forEach(b => b.classList.remove('bg-blue-600', 'text-white'));
            btn.classList.add('bg-blue-600', 'text-white');
            const filtered = c === 'å…¨éƒ¨' ? rawData : rawData.filter(d => d.company === c);
            render(filtered);
        }

        init();
    </script>
</body>
</html>
